import csv
import random
import time
from datetime import datetime  # 时间转换
import requests

f = open('转发500.csv', mode='a', encoding='utf-8—sig', newline='\n')
csv_writer = csv.DictWriter(f, fieldnames=[
    '文章id',
    '博主ID',
    '用户名称',
    '用户ID',
    '会员',
    '点赞',
    '转发时间',
    '文本',
    '用户链接',
    '用户简介',
    '用户粉丝',
    '用户关注',
    '用户认证',
    '用户IP',
    '用户性别',
    '生日',
    '加入微博时间',
    '用户发布微博数量',
    '用户标签',
    '近期文章',

])
csv_writer.writeheader()

cookies = {
        'UOR': 'www.baidu.com,weibo.com,www.baidu.com',
                    'SINAGLOBAL': '2649348612320.8965.1683123322503',
                    'SUBP': '0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f',
                    'ULV': '1684137851028:3:3:1:6238390337761.372.1684137850994:1683377818731',
                    'XSRF-TOKEN': 'Esh3O_pyGuemuWbImpjxEg_i',
                    'SSOLoginState': '1684306503',
                    'ALF': '1686985644',
                    'SCF': 'AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HR92YdrUEU0AgXTY-y9_cYtik_Qmx4OZgolQ3jofOBljM.',
                    'SUB': '_2A25JYb78DeRhGeFG6FAZ8ybPyTyIHXVqFpc0rDV8PUNbmtANLXjQkW9NedA6PQ8S4BZRBkaMXlcfgXMLdFCmNH-z',
                    'WBPSESS': 'LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYeeD2aNiEHSFkTzLwCJ8eDVyDn98X_xy5lBgz2sSkmym1I30_tOI-4oNkTc6pJyDGadk4h81IXvAsiTRYcZG-zPKQ==',
                }
headers = {
    'authority': 'weibo.com',
    'accept': 'application/json, text/plain, */*',
    'accept-language': 'zh-CN,zh;q=0.9',
    'cache-control': 'no-cache',
    'client-version': 'v2.40.50',
    # 'cookie': 'UOR=www.baidu.com,weibo.com,www.baidu.com; SINAGLOBAL=2649348612320.8965.1683123322503; ULV=1683377818731:2:2:2:713788954594.1056.1683377818729:1683123322509; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f; XSRF-TOKEN=obwd0Ov25cOoAxnDd_5v8cEi; ALF=1686548441; SSOLoginState=1683956441; SCF=AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HRSS219iAnfrZOyhWhEArwyW12K83xSaYYodhqvR0khPA.; SUB=_2A25JW1KJDeRhGeFG6FAZ8ybPyTyIHXVqEcNBrDV8PUNbmtANLXb8kW9NedA6PWkulW4ou_UizHm4YQLCTcXtpWAV; WBPSESS=LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYee1hd8RESfQYZdS7Na4nHW5Kzqvy-yw86sl2rV_7IxfgdaqJFP2ZMPmi_8_kB93-6MXGBHNybUk1k56X_AwaBg4w==',
    'pragma': 'no-cache',
    'referer': 'https://weibo.com/u/1057289387',
    'sec-ch-ua': '"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'sec-fetch-dest': 'empty',
    'sec-fetch-mode': 'cors',
    'sec-fetch-site': 'same-origin',
    'server-version': 'v2023.05.11.1',
    'traceparent': '00-a05718a7653e565bb8ba3d0166c7b1a7-2242690b57e76b7c-00',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36',
    'x-requested-with': 'XMLHttpRequest',
    'x-xsrf-token': 'obwd0Ov25cOoAxnDd_5v8cEi',
}

data = [
        '4830640443230494',
        '4889084159330986',
        '4791617129289319',
        '4839630543783191',
        '4822091348575049',
        '4820621747292398',
        '4767189314311613',
        '4771925416741864',
        '4839624281429645',
        '4809303757950079',
        '4839620729374152',
        '4811017261159209',
        '4770547462832918',
        '4833666151220288',
        '4864735234758253',
        '4764082987865333',
        '4763899872678602',
        '4872778085828939',
        '4839093009650807',
        '4788244120339260',
        '4769758908781482',
        '4759644104822893',
        '4780314695568478',
        '4781000908869181',
        '4844709409723330',
        '4785969922573582',
        '4840359529810832',
        '4851972261811002',
        '4760016630582037',
        '4757777454466415',
        '4867270155439793',
        '4844071673402317',
        '4799188736936117',
        '4879517401745070',
        '4766243761949455',
        '4758634360209933',
        '4833603835402039',
        '4821620697075034',
        '4809647992605328',
        '4767292023375216',
        '4787455512018996',
        '4835858593878387',
        '4785673763292856',
        '4767544042587244',
        '4782038093400270',
        '4803556513941210',
        '4762282694807889',
        '4801365999618346',
        '4769663709610671',
        '4863614987537394',
        '4795252706119571',
        '4758611039359945',
        '4763242607414890',
        '4759988700448545',
        '4830376414942581',
        '4841441249987524',
        '4844099632633882',
        '4822675614335203',
        '4785772462866703',
        '4869368820796690',
        '4851321020882091',
        '4867202631077991',
        '4822618735645223',
        '4841125297000989',
        '4841939293179775',
        '4856385542817777',
        '4841890182598562',
        '4789264417556778',
        '4823813525342202',
        '4762473679030795',
        '4772322404205831',
        '4840080479617648',
        '4828854550003899',
        '4771227194888470',
        '4872783286771606',
        '4813636340288467',
        '4773134035588627',
        '4873812502646954',
        '4869451042260631',
        '4768664660216950',
        '4782368169394842',
        '4782189579601403',
        '4853140237325970',
        '4816806399185025',
        '4812169508295882',
        '4817576909865874',
        '4781008832955464',
        '4802322184015827',
        '4869004798463354',
        '4882148383000054',
        '4767517137174798',
        '4811726677347422',
        '4806292214383253',
        '4802669338691186',
        '4810366015509615',
        '4867262962732544',
        '4811480900045039',
        '4824900299131999',
        '4775101172809910',
        '4778884619044496',
        '4840425611334848',
        '4806133199671194',
        '4867213549373392',
        '4755652943285421',
        '4785786078364678',
        '4805629892103785',
        '4810336082071664',
        '4875183157941997',
        '4790420779567254',
        '4754299629864562',
        '4778645829451974',
        '4753829428725861',
        '4808651414182100',
        '4787519231889116',
        '4820530940873435',
        '4799183780054943',
        '4818341522312611',
        '4791216531047954',
        '4787466210383868',
        '4874133572422519',
        '4817275498266917',
        '4800153653085886',
        '4787483881246596',
        '4811443251973919',
        '4846314128417408',
        '4811017655157220',
        '4812636049121148',
        '4852062460059448',
        '4873788355513215',
        '4834667896771157',
        '4835730897505247',
        '4876672664340223',
        '4763862546514026',
        '4805579237753761',
        '4805555731828703',
        '4841165167532378',
        '4878893058886510',
        '4843351322920837',
        '4885049574949884',
        '4879233225067613',
        '4843702968649453',
        '4831027857982107',
        '4786489131273774',
        '4782072528377964',
        '4885403586528876',
        '4871661696062202',
        '4866227636013125',
        '4891575022525092',
        '4874908028378304',
        '4864285219490883',
        '4858173989061730',
        '4828406568718748',
        '4818689536299701',
        '4767239851216521',
        '4778044042773915',
        '4869438723851067',
        '4849504333862109',
        '4848784792890439',
        '4782440113768523',
        '4834206776297514',
        '4866086443419998',
        '4787460125753691',
        '4882764010359698',
        '4866471047464377',
        '4843633222885682',
        '4844354173145687',
        '4802364990819020',
        '4791516771912914',
        '4784902341919144',
        '4783903749178298',
        '4781654130296175',
        '4759287416490199',
        '4759242106735934',
        '4758925008176777',
        '4818709819949383',
        '4804576689784685',
        '4763980209850154',
        '4757833566652335',
        '4854869120254215',
        '4849118519761745',
        '4846234412522106',
        '4843982749701606',
        '4841175095448649',
        '4840409434691626',
        '4818353363355089',
        '4777746829934674',
        '4874911774413785',
        '4841099309617637',
        '4831306217161203',
        '4804948267634585',
        '4783916239553600',
        '4888614565319745',
        '4846899695457434',
        '4836832666459189',
        '4808957182608342',
        '4800146876139783',
        '4764253942712721',
        '4761371129939650',
        '4758188417354226',
        '4869062439732351',
        '4851657571573339',
        '4849509395597994',
        '4837895376996700',
        '4793341030700586',
        '4787456384436807',
        '4853783287563854',
        '4883873870123434',
        '4757804500650280',
        '4865331150194712',
        '4724751244984505',
        '4864733230140087',
        '4886387587548742',
        '4888508864399387',
        '4842269524361313',
        '4832038006557469',
        '4883911837222655',
        '4874826902410325',
        '4764623553433168',
        '4883923270107865',
        '4852345584754115',
        '4889299038504703',
        '4883880878542826',
        '4886387587548742',
        '4834676659980333',
        '4851207531142326',
        '4853792224321829',
        '4819393416530042',
        '4832041926924228',
        '4885338922682227',
        '4849876891875728',
        '4864734723312542',
        '4859985923933402',
        '4885049574949884',
        '4787456384436807',
        '4765773871187276',
        '4769766399804227',
        '4758969623514816',
        '4842361878748790',
        '4757772719099682',
        '4839354214391122',
        '4853783287563854',
        '4828451234382414',
        '4842186628137151',
        '4883873870123434',
        '4773677935887348',
        '4864733230140087',
        '4765711635056788',
        '4808883841274418',
        '4876757263453475',
        '4791398790594780',
        '4854159356726658',
        '4843448202695032',
        '4789056054236867',
        '4845393839916809',
        '4819381630801917',
        '4807424140119295',
        '4757741203620180',
        '4799159930457527',
        '4847250763680549',
        '4853485596051227',
        '4832038006557469',
        '4768743639223955',
        '4848478993515567',
        '4863695869444137',
        '4842274229587231',
        '4884331137075448',
        '4786698007088669',
        '4844723958722863',
        '4813574104681036',
        '4848415949983867',
        '4779193416026897',
        '4853027850948981',
        '4878893058886510',
        '4844366860386734',
        '4852836565786675',
        '4885049574949884',
        '4876366808354443',
        '4879233225067613',
        '4765333426276070',
        '4877075971834200',
        '4883911837222655',
        '4809658844578212',
        '4767320096639649',
        '4847722063989992',
        '4829928581237169',
        '4882876577875959',
        '4872382394665409',
        '4816544536989108',
        '4828406568718748',
        '4778044042773915',
        '4873839860783143',
        '4876711072894590',
        '4819358926766640',
        '4782440113768523',
        '4849504333862109',
        '4879610967491587',
        '4791780895099467',
        '4837480614858488',
        '4834206776297514',
        '4802775748183893',
        '4865095340919642',
        '4770467409822856',
        '4843633222885682',
        '4840740746428758',
        '4844354173145687',
        '4818709819949383',
        '4830312401998920',
        '4865748805093183',
        '4845421237109544',
        '4761836701878470',
        '4846234412522106',
        '4840409434691626',
        '4840043518101755',
        '4841175095448649',
        '4837182601429630',
        '4849118519761745',
        '4854550105687991',
        '4851974736976042',
        '4854572692540310',
        '4842885758847147',
        '4841099309617637',
        '4865392294497475',
        '4889753633167255',
        '4889753633167250',
]
for c in data:
    for i in range(1, 1000):
        # da=f'page={i}&moduleID=feed&count=10'
        url = f'https://weibo.com/ajax/statuses/repostTimeline?id={c}&page={i}&moduleID=feed&count=20'
        print(url)
        response = requests.get(url=url,cookies=cookies,headers=headers).json()
        print(response)
        list_ids = response.get('data')
        if not list_ids:
                break
                print('没有数据')
        else:
             list_ids=response.get('data')
             # print(list_ids)
        time.sleep(6)
        for list in list_ids:
            try:
                list_titie_id = list.get('retweeted_status').get('mblogid')  # 文章id
                # print(list_titie_id)
                list_id_name = list.get('retweeted_status').get('user').get('id')  # 博主ID
                list_name = list.get('user').get('screen_name')  # 用户名称
                list_id = list.get('user').get('id')  # 用户ID
                list_mbrank = list.get('user').get('mbrank')  # 会员
                list_attitudes_count = list.get('attitudes_count')  # 点赞
                Comment_time = list.get('created_at')
                d = Comment_time
                list_created_at = datetime.strptime(d, '%a %b %d %X %z %Y')  # 转发时间
                list_text_raw1 = list.get('text_raw')  # 文本
                list_url = 'https://weibo.com/u/' + str(list_id)  # 用户链接
                cookies_1 = {
                    'UOR': 'www.baidu.com,weibo.com,www.baidu.com',
                    'SINAGLOBAL': '2649348612320.8965.1683123322503',
                    'SUBP': '0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f',
                    'ULV': '1684137851028:3:3:1:6238390337761.372.1684137850994:1683377818731',
                    'XSRF-TOKEN': 'Esh3O_pyGuemuWbImpjxEg_i',
                    'SSOLoginState': '1684306503',
                    'ALF': '1686985644',
                    'SCF': 'AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HR92YdrUEU0AgXTY-y9_cYtik_Qmx4OZgolQ3jofOBljM.',
                    'SUB': '_2A25JYb78DeRhGeFG6FAZ8ybPyTyIHXVqFpc0rDV8PUNbmtANLXjQkW9NedA6PQ8S4BZRBkaMXlcfgXMLdFCmNH-z',
                    'WBPSESS': 'LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYeeD2aNiEHSFkTzLwCJ8eDVyDn98X_xy5lBgz2sSkmym1I30_tOI-4oNkTc6pJyDGadk4h81IXvAsiTRYcZG-zPKQ==',
                }
                headers_1 = {
                    'authority': 'weibo.com',
                    'accept': 'application/json, text/plain, */*',
                    'accept-language': 'zh-CN,zh;q=0.9',
                    'cache-control': 'no-cache',
                    'client-version': 'v2.40.50',
                    # 'cookie': 'UOR=www.baidu.com,weibo.com,www.baidu.com; SINAGLOBAL=2649348612320.8965.1683123322503; ULV=1683377818731:2:2:2:713788954594.1056.1683377818729:1683123322509; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f; XSRF-TOKEN=obwd0Ov25cOoAxnDd_5v8cEi; ALF=1686548441; SSOLoginState=1683956441; SCF=AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HRSS219iAnfrZOyhWhEArwyW12K83xSaYYodhqvR0khPA.; SUB=_2A25JW1KJDeRhGeFG6FAZ8ybPyTyIHXVqEcNBrDV8PUNbmtANLXb8kW9NedA6PWkulW4ou_UizHm4YQLCTcXtpWAV; WBPSESS=LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYee1hd8RESfQYZdS7Na4nHW5Kzqvy-yw86sl2rV_7IxfgdaqJFP2ZMPmi_8_kB93-6MXGBHNybUk1k56X_AwaBg4w==',
                    'pragma': 'no-cache',
                    'referer': 'https://weibo.com/u/1057289387',
                    'sec-ch-ua': '"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',
                    'sec-ch-ua-mobile': '?0',
                    'sec-ch-ua-platform': '"Windows"',
                    'sec-fetch-dest': 'empty',
                    'sec-fetch-mode': 'cors',
                    'sec-fetch-site': 'same-origin',
                    'server-version': 'v2023.05.11.1',
                    'traceparent': '00-a05718a7653e565bb8ba3d0166c7b1a7-2242690b57e76b7c-00',
                    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36',
                    'x-requested-with': 'XMLHttpRequest',
                    'x-xsrf-token': 'obwd0Ov25cOoAxnDd_5v8cEi', }
                params_1 = {
                    'uid': list_id,
                }
               # time.sleep(random.randint(2, 5))
                response_1 = requests.get('https://weibo.com/ajax/profile/info', params=params_1,
                                          cookies=cookies_1,
                                          headers=headers_1).json()
                # print(response_1)
                list_description = response_1.get('data').get('user').get('description')  # 用户简介
                list_followers_count_str = response_1.get('data').get('user').get(
                    'followers_count_str')  # 用户粉丝
                list_friends_count = response_1.get('data').get('user').get('friends_count')  # 用户关注
                list_verified_reason = response_1.get('data').get('user').get('verified_reason')  # 用户认证
                list_location = response_1.get('data').get('user').get('location')  # 用户IP
                list_gender = response_1.get('data').get('user').get('gender')  # 用户性别
                # print(list_location)
                fd = 'f'
                if list_gender == fd:
                    list_gender = '女'
                else:
                    list_gender = '男'
                cookies_2 = {
                    'UOR': 'www.baidu.com,weibo.com,www.baidu.com',
                    'SINAGLOBAL': '2649348612320.8965.1683123322503',
                    'SUBP': '0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f',
                    'ULV': '1684137851028:3:3:1:6238390337761.372.1684137850994:1683377818731',
                    'XSRF-TOKEN': 'Esh3O_pyGuemuWbImpjxEg_i',
                    'SSOLoginState': '1684306503',
                    'ALF': '1686985644',
                    'SCF': 'AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HR92YdrUEU0AgXTY-y9_cYtik_Qmx4OZgolQ3jofOBljM.',
                    'SUB': '_2A25JYb78DeRhGeFG6FAZ8ybPyTyIHXVqFpc0rDV8PUNbmtANLXjQkW9NedA6PQ8S4BZRBkaMXlcfgXMLdFCmNH-z',
                    'WBPSESS': 'LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYeeD2aNiEHSFkTzLwCJ8eDVyDn98X_xy5lBgz2sSkmym1I30_tOI-4oNkTc6pJyDGadk4h81IXvAsiTRYcZG-zPKQ==',
                }
                headers_2 = {
                    'authority': 'weibo.com',
                    'accept': 'application/json, text/plain, */*',
                    'accept-language': 'zh-CN,zh;q=0.9',
                    'cache-control': 'no-cache',
                    'client-version': 'v2.40.50',
                    # 'cookie': 'UOR=www.baidu.com,weibo.com,www.baidu.com; SINAGLOBAL=2649348612320.8965.1683123322503; ULV=1683377818731:2:2:2:713788954594.1056.1683377818729:1683123322509; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f; XSRF-TOKEN=obwd0Ov25cOoAxnDd_5v8cEi; ALF=1686548441; SSOLoginState=1683956441; SCF=AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HRSS219iAnfrZOyhWhEArwyW12K83xSaYYodhqvR0khPA.; SUB=_2A25JW1KJDeRhGeFG6FAZ8ybPyTyIHXVqEcNBrDV8PUNbmtANLXb8kW9NedA6PWkulW4ou_UizHm4YQLCTcXtpWAV; WBPSESS=LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYee1hd8RESfQYZdS7Na4nHW5Kzqvy-yw86sl2rV_7IxfgdaqJFP2ZMPmi_8_kB93-6MXGBHNybUk1k56X_AwaBg4w==',
                    'pragma': 'no-cache',
                    'referer': 'https://weibo.com/u/1057289387',
                    'sec-ch-ua': '"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',
                    'sec-ch-ua-mobile': '?0',
                    'sec-ch-ua-platform': '"Windows"',
                    'sec-fetch-dest': 'empty',
                    'sec-fetch-mode': 'cors',
                    'sec-fetch-site': 'same-origin',
                    'server-version': 'v2023.05.11.1',
                    'traceparent': '00-a05718a7653e565bb8ba3d0166c7b1a7-2242690b57e76b7c-00',
                    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36',
                    'x-requested-with': 'XMLHttpRequest',
                    'x-xsrf-token': 'obwd0Ov25cOoAxnDd_5v8cEi', }

                params_2 = {
                    'uid': list_id,
                }

                response_2 = requests.get('https://weibo.com/ajax/profile/detail', params=params_2,
                                          cookies=cookies_2,
                                          headers=headers_2).json()
                # print(response_2)
                cookies_3 = {
                    'UOR': 'www.baidu.com,weibo.com,www.baidu.com',
                    'SINAGLOBAL': '2649348612320.8965.1683123322503',
                    'SUBP': '0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f',
                    'ULV': '1684137851028:3:3:1:6238390337761.372.1684137850994:1683377818731',
                    'XSRF-TOKEN': 'Esh3O_pyGuemuWbImpjxEg_i',
                    'SSOLoginState': '1684306503',
                    'ALF': '1686985644',
                    'SCF': 'AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HR92YdrUEU0AgXTY-y9_cYtik_Qmx4OZgolQ3jofOBljM.',
                    'SUB': '_2A25JYb78DeRhGeFG6FAZ8ybPyTyIHXVqFpc0rDV8PUNbmtANLXjQkW9NedA6PQ8S4BZRBkaMXlcfgXMLdFCmNH-z',
                    'WBPSESS': 'LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYeeD2aNiEHSFkTzLwCJ8eDVyDn98X_xy5lBgz2sSkmym1I30_tOI-4oNkTc6pJyDGadk4h81IXvAsiTRYcZG-zPKQ==',
                }
                headers_3 = {
                    'authority': 'weibo.com',
                    'accept': 'application/json, text/plain, */*',
                    'accept-language': 'zh-CN,zh;q=0.9',
                    'cache-control': 'no-cache',
                    'client-version': 'v2.40.50',
                    # 'cookie': 'UOR=www.baidu.com,weibo.com,www.baidu.com; SINAGLOBAL=2649348612320.8965.1683123322503; ULV=1683377818731:2:2:2:713788954594.1056.1683377818729:1683123322509; SUBP=0033WrSXqPxfM725Ws9jqgMF55529P9D9W5iFY70K82Pxs3e8U2VB8g25JpX5KMhUgL.FoMRe0zRe0n0eo52dJLoIEzLxK-LB-qLBo.LxK-LB-qLBo.LxK-LB-qLBoLkeo5Ee05f; XSRF-TOKEN=obwd0Ov25cOoAxnDd_5v8cEi; ALF=1686548441; SSOLoginState=1683956441; SCF=AiY6_xhGYt00HPRl7b6wPZDN_qdWxa2lmLM5DQP4y-HRSS219iAnfrZOyhWhEArwyW12K83xSaYYodhqvR0khPA.; SUB=_2A25JW1KJDeRhGeFG6FAZ8ybPyTyIHXVqEcNBrDV8PUNbmtANLXb8kW9NedA6PWkulW4ou_UizHm4YQLCTcXtpWAV; WBPSESS=LRG5opETtpCx6hjj5OrpxsIue_hf0zCivLYWxpShWfkMijk3IM20fE4MW_g2ZYee1hd8RESfQYZdS7Na4nHW5Kzqvy-yw86sl2rV_7IxfgdaqJFP2ZMPmi_8_kB93-6MXGBHNybUk1k56X_AwaBg4w==',
                    'pragma': 'no-cache',
                    'referer': 'https://weibo.com/u/1057289387',
                    'sec-ch-ua': '"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',
                    'sec-ch-ua-mobile': '?0',
                    'sec-ch-ua-platform': '"Windows"',
                    'sec-fetch-dest': 'empty',
                    'sec-fetch-mode': 'cors',
                    'sec-fetch-site': 'same-origin',
                    'server-version': 'v2023.05.11.1',
                    'traceparent': '00-a05718a7653e565bb8ba3d0166c7b1a7-2242690b57e76b7c-00',
                    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36',
                    'x-requested-with': 'XMLHttpRequest',
                    'x-xsrf-token': 'obwd0Ov25cOoAxnDd_5v8cEi', }
                params_3 = {
                    'uid': list_id,
                    'page': '1',
                    'feature': '0',
                }
                #time.sleep(random.randint(2, 10))
                response_3 = requests.get('https://weibo.com/ajax/statuses/mymblog', params=params_3,
                                          cookies=cookies_3,
                                          headers=headers_3).json()
                # print(response_3)
                data_list = response_3.get('data').get('list')
                list_data = response_2.get('data').get('label_desc')
                list_birthday = response_2.get('data').get('birthday')  # 生日
                list_time = response_2.get('data').get('created_at')  # 加入微博时间
                list_time_quantity = response_3.get('data').get('total')  # 用户发布微博数量
                # print(list_time_quantity)
                list_da = []
                list_text_raw = []
                for list_2 in list_data:
                    da = list_2.get('name')
                    list_da.append(da)  # 用户标签
                for list_3 in data_list:
                    dau7 = list_3.get('text_raw')
                    list_text_raw.append(dau7)  # 近期文章
                    # print(list_text_raw)
                dit = {
                    '文章id': list_titie_id,
                    '博主ID': list_id_name,
                    '用户名称': list_name,
                    '用户ID': list_id,
                    '会员': list_mbrank,
                    '点赞': list_attitudes_count,
                    '转发时间': list_created_at,
                    '文本': list_text_raw1,
                    '用户链接': list_url,
                    '用户简介': list_description,
                    '用户粉丝': list_followers_count_str,
                    '用户关注': list_friends_count,
                    '用户认证': list_verified_reason,
                    '用户IP': list_location,
                    '用户性别': list_gender,
                    '生日': list_birthday,
                    '加入微博时间': list_time,
                    '用户发布微博数量': list_time_quantity,
                    '用户标签': list_da,
                    '近期文章': list_text_raw,
                }
                csv_writer.writerow(dit)
                # print(dit)
                print('下载完毕!',list_titie_id,list_id_name,list_name,list_id,list_mbrank,list_attitudes_count,list_created_at,list_text_raw1,
                      list_url,list_description,list_followers_count_str,list_friends_count,
                      list_verified_reason,list_location,list_gender,list_birthday,
                      list_time,list_time_quantity,list_da,list_text_raw)
            except Exception as e:
                e
